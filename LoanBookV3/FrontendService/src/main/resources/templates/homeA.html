<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="/css/homeA.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
</head>
<body>

<div class="hamburger" onclick="toggleSidebar()">
    <i class="fas fa-bars"></i>
</div>

<div class="sidebar" id="sidebar">
    <h1>Admin Dashboard</h1>
    <ul>
        <li><a href="#"><i class="fas fa-tachometer-alt"></i>Dashboard</a></li>
        <li><a href="#" id="view-users"><i class="fas fa-users"></i>Users</a></li>
        <li><a href="#" id="view-books"><i class="fas fa-book"></i>Books</a></li>
        <li><a href="#"><i class="fas fa-cog"></i>Settings</a></li>
        <li><a href="#" id="logout"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
    </ul>
</div>


<!--list of the users here !-->
<div class="content">
    <div class="header">
        <h2>Welcome to the Admin Dashboard</h2>
        <!--For returning books from expired reservations-->
        <div id="flashMessage" class="flash-message"></div>
    </div>
    <div id="user-list-section" style="display: none;">
        <h2>List of Users</h2>
        <table id="user-list" class="table">
            <thead>
            <tr>
                <th>Nom</th>
                <th>Prenom</th>
                <th>Email</th>
                <th>Role</th>
                <th>Reserved books</th>
            </tr>
            </thead>
            <tbody>
            <!-- User rows will be appended here -->
            </tbody>
        </table>
        <!--For returning books from expired reservations-->
        <button id="returnBooksBtn" class="fas fa-arrow-circle-left">Return Books</button>
    </div>



    <!--List of the books here-->
    <div id="book-list-section" style="display: none;">
        <h2>List of Books</h2>
        <table id="book-list" class="table">
            <thead>
            <tr>
                <th>author</th>
                <th>number of books</th>
                <th>title</th>
                <th>reservation number</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            <!-- Book rows will be appended here -->
            </tbody>
        </table>


        <!--For Adding a book-->
        <button id="add-book-btn">+ Add Book</button>
        <div id="add-book-form" style="display:none;">
            <form id="new-book-form">
                <label for="author">Author:</label>
                <input type="text" id="author" name="author" required><br>
                <label for="nb_of_books">Number of Books:</label>
                <input type="number" id="nb_of_books" name="nb_of_books" required><br>
                <label for="title">Title:</label>
                <input type="text" id="title" name="title" required><br>
                <button type="submit">Submit</button>
            </form>
        </div>





        <!--For updating a book-->
        <div id="edit-book-form" style="display:none;">
            <form id="update-book-form">
                <input type="hidden" id="edit-book-id">
                <label for="edit-author">Author:</label>
                <input type="text" id="edit-author" name="edit-author" required><br>
                <label for="edit-nb_of_books">Number of Books:</label>
                <input type="number" id="edit-nb_of_books" name="edit-nb_of_books" required><br>
                <label for="edit-title">Title:</label>
                <input type="text" id="edit-title" name="edit-title" required><br>
                <button type="submit">Update</button>
            </form>
        </div>
    </div>
</div>

<script>
    function toggleSidebar() {
        var sidebar = document.getElementById("sidebar");
        sidebar.classList.toggle("active");
    }
</script>



<!--Script for the session check-->
<script>
    $(document).ready(function() {
        const LocalUrl = '/api/frontend';
        // Check if UserId is available
        const UserId = localStorage.getItem('id');
        const role = localStorage.getItem('role');
        if (!UserId||role==='SUBSCRIBER') {
            // If no UserId, redirect to loginError
            window.location.href = LocalUrl+'loginError';
        }
    });
</script>
<script src="/javascript/homeA.js"></script>
</body>
</html>